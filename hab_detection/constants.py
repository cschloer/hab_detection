import torch
import numpy as np

ZIP_PATH_TRAIN = "/shared/datasets/hab/new_data/dataset_train.zip"
ZIP_PATH_TEST = "/shared/datasets/hab/new_data/dataset_test.zip"
# ZIP_PATH_TRAIN = "/shared/datasets/hab/data/dataset4_train.zip"
# ZIP_PATH_TEST = "/shared/datasets/hab/data/dataset4_test.zip"
# ZIP_PATH_TRAIN = "/shared/datasets/hab/data/dataset_dist_train.zip"
# ZIP_PATH_TEST = "/shared/datasets/hab/data/dataset_dist_test.zip"
# ZIP_PATH_TRAIN = "/home/conrad/new_data/dataset_train.zip"
# ZIP_PATH_TEST = "/home/conrad/new_data/dataset_test.zip"

# STRUCTURED_FOLDER_PATH_TRAIN = "/shared/datasets/hab/new_data/dataset_train_structured"
# STRUCTURED_FOLDER_PATH_TEST = "/shared/datasets/hab/new_data/dataset_test_structured"
STRUCTURED_FOLDER_PATH_TRAIN = "/ssd/hab/data/dataset_train_structured"
STRUCTURED_FOLDER_PATH_TEST = "/ssd/hab/data/dataset_test_structured"

# MODEL_SAVE_BASE_FOLDER = "/shared/datasets/hab/models"
MODEL_SAVE_BASE_FOLDER = "/home/conrad/results/models"
LOG_NAME = "log.txt"

# FULL_IMAGE_BASE_FOLDER = "/shared/datasets/hab/images"
FULL_IMAGE_BASE_FOLDER = "/home/conrad/results/images"


device = torch.device("cuda") if torch.cuda.is_available() else torch.device("cpu")
print(device)

# Dataset mean and std calculated using run_dataset_staticics.py
# For old dataset
"""
dataset_mean = [
    0.04235201,
    0.04784579,
    0.05547756,
    0.04363304,
    0.05092298,
    0.05012781,
    0.05277098,
    0.05194422,
    0.05095484,
    0.05174823,
    0.03550878,
    0.02762647,
]
dataset_std = [
    0.05505946,
    0.05726197,
    0.0569017,
    0.0569323,
    0.06115186,
    0.07730392,
    0.0840756,
    0.08879628,
    0.08847726,
    0.10554088,
    0.06592033,
    0.05038361,
]
"""
# For new dataset
dataset_mean = [
    0.0367425,
    0.04384967,
    0.05643992,
    0.04752899,
    0.05311135,
    0.04531556,
    0.04827843,
    0.04772811,
    0.04578368,
    0.04437868,
    0.03240987,
    0.02406007,
]
dataset_std = [
    0.04898498,
    0.05039225,
    0.05055515,
    0.05064571,
    0.05497834,
    0.0692344,
    0.07566278,
    0.08037745,
    0.08150004,
    0.10058163,
    0.06478662,
    0.04916096,
]
cyan_colormap = np.array(
    [
        [149, 149, 149, 255],
        [71, 24, 106, 255],
        [71, 25, 107, 255],
        [71, 27, 109, 255],
        [71, 29, 111, 255],
        [71, 31, 112, 255],
        [71, 32, 113, 255],
        [71, 33, 114, 255],
        [71, 34, 115, 255],
        [70, 36, 116, 255],
        [70, 38, 118, 255],
        [70, 39, 119, 255],
        [70, 41, 120, 255],
        [70, 42, 121, 255],
        [70, 43, 122, 255],
        [69, 44, 123, 255],
        [69, 47, 124, 255],
        [69, 48, 125, 255],
        [68, 49, 126, 255],
        [68, 51, 126, 255],
        [68, 52, 127, 255],
        [68, 53, 128, 255],
        [67, 56, 129, 255],
        [66, 57, 130, 255],
        [66, 58, 130, 255],
        [66, 59, 131, 255],
        [65, 60, 131, 255],
        [65, 61, 132, 255],
        [64, 64, 133, 255],
        [64, 65, 133, 255],
        [63, 66, 134, 255],
        [63, 67, 134, 255],
        [62, 68, 134, 255],
        [62, 70, 135, 255],
        [61, 72, 136, 255],
        [60, 73, 136, 255],
        [60, 74, 136, 255],
        [60, 75, 136, 255],
        [59, 76, 137, 255],
        [59, 77, 137, 255],
        [58, 80, 137, 255],
        [57, 81, 138, 255],
        [57, 82, 138, 255],
        [56, 83, 138, 255],
        [56, 84, 138, 255],
        [55, 85, 138, 255],
        [54, 87, 139, 255],
        [54, 88, 139, 255],
        [53, 89, 139, 255],
        [53, 90, 139, 255],
        [52, 91, 139, 255],
        [52, 92, 139, 255],
        [51, 94, 140, 255],
        [50, 95, 140, 255],
        [50, 96, 140, 255],
        [49, 97, 140, 255],
        [49, 98, 140, 255],
        [48, 99, 140, 255],
        [48, 101, 140, 255],
        [47, 102, 140, 255],
        [47, 103, 140, 255],
        [46, 104, 140, 255],
        [46, 105, 140, 255],
        [45, 107, 141, 255],
        [45, 108, 141, 255],
        [44, 109, 141, 255],
        [44, 110, 141, 255],
        [43, 111, 141, 255],
        [43, 112, 141, 255],
        [42, 114, 141, 255],
        [42, 115, 141, 255],
        [41, 116, 141, 255],
        [41, 117, 141, 255],
        [41, 118, 141, 255],
        [40, 119, 141, 255],
        [39, 121, 141, 255],
        [39, 121, 141, 255],
        [39, 122, 141, 255],
        [38, 123, 141, 255],
        [38, 124, 141, 255],
        [38, 125, 141, 255],
        [37, 127, 141, 255],
        [37, 128, 141, 255],
        [36, 129, 141, 255],
        [36, 130, 140, 255],
        [35, 131, 140, 255],
        [35, 132, 140, 255],
        [34, 134, 140, 255],
        [34, 135, 140, 255],
        [34, 136, 140, 255],
        [33, 136, 140, 255],
        [33, 137, 140, 255],
        [33, 138, 140, 255],
        [32, 140, 139, 255],
        [32, 141, 139, 255],
        [31, 142, 139, 255],
        [31, 143, 139, 255],
        [31, 144, 139, 255],
        [30, 145, 139, 255],
        [30, 147, 138, 255],
        [30, 148, 138, 255],
        [30, 149, 138, 255],
        [29, 150, 137, 255],
        [29, 151, 137, 255],
        [29, 152, 137, 255],
        [29, 153, 136, 255],
        [29, 154, 136, 255],
        [29, 155, 136, 255],
        [29, 156, 135, 255],
        [29, 157, 135, 255],
        [29, 158, 135, 255],
        [30, 160, 134, 255],
        [30, 161, 133, 255],
        [30, 162, 133, 255],
        [31, 163, 132, 255],
        [31, 164, 132, 255],
        [32, 165, 132, 255],
        [33, 166, 131, 255],
        [34, 167, 130, 255],
        [34, 168, 129, 255],
        [35, 169, 129, 255],
        [36, 170, 128, 255],
        [37, 171, 128, 255],
        [39, 173, 126, 255],
        [40, 174, 126, 255],
        [41, 175, 125, 255],
        [42, 176, 124, 255],
        [43, 176, 124, 255],
        [45, 177, 123, 255],
        [47, 179, 121, 255],
        [49, 180, 121, 255],
        [50, 181, 120, 255],
        [52, 182, 119, 255],
        [53, 183, 118, 255],
        [56, 184, 117, 255],
        [58, 185, 116, 255],
        [60, 186, 115, 255],
        [61, 187, 114, 255],
        [63, 188, 113, 255],
        [65, 189, 112, 255],
        [68, 190, 110, 255],
        [70, 191, 109, 255],
        [72, 192, 108, 255],
        [74, 193, 107, 255],
        [76, 193, 106, 255],
        [78, 194, 104, 255],
        [82, 196, 102, 255],
        [84, 197, 101, 255],
        [86, 197, 100, 255],
        [88, 198, 99, 255],
        [90, 199, 97, 255],
        [93, 200, 96, 255],
        [97, 201, 94, 255],
        [99, 202, 92, 255],
        [102, 203, 91, 255],
        [104, 203, 90, 255],
        [106, 204, 88, 255],
        [108, 205, 87, 255],
        [113, 206, 84, 255],
        [115, 207, 83, 255],
        [118, 207, 81, 255],
        [120, 208, 80, 255],
        [123, 209, 78, 255],
        [125, 209, 77, 255],
        [130, 210, 74, 255],
        [133, 211, 72, 255],
        [135, 212, 70, 255],
        [138, 212, 69, 255],
        [140, 213, 67, 255],
        [143, 213, 66, 255],
        [148, 214, 62, 255],
        [150, 215, 61, 255],
        [153, 215, 59, 255],
        [156, 216, 57, 255],
        [158, 216, 55, 255],
        [161, 217, 54, 255],
        [166, 218, 50, 255],
        [169, 218, 49, 255],
        [172, 219, 47, 255],
        [174, 219, 45, 255],
        [177, 220, 43, 255],
        [180, 220, 42, 255],
        [185, 221, 38, 255],
        [188, 221, 37, 255],
        [190, 222, 35, 255],
        [193, 222, 33, 255],
        [196, 222, 32, 255],
        [198, 223, 30, 255],
        [203, 219, 27, 255],
        [209, 216, 24, 255],
        [215, 214, 21, 255],
        [218, 210, 21, 255],
        [220, 206, 19, 255],
        [223, 201, 18, 255],
        [225, 196, 16, 255],
        [227, 191, 15, 255],
        [229, 187, 14, 255],
        [231, 182, 12, 255],
        [234, 177, 11, 255],
        [236, 173, 10, 255],
        [238, 168, 8, 255],
        [240, 163, 7, 255],
        [242, 158, 5, 255],
        [245, 154, 4, 255],
        [247, 149, 3, 255],
        [249, 144, 1, 255],
        [251, 139, 0, 255],
        [254, 135, 0, 255],
        [254, 130, 0, 255],
        [254, 124, 0, 255],
        [254, 119, 0, 255],
        [254, 114, 0, 255],
        [254, 109, 0, 255],
        [254, 103, 0, 255],
        [254, 98, 0, 255],
        [254, 93, 0, 255],
        [254, 88, 0, 255],
        [254, 82, 0, 255],
        [254, 77, 0, 255],
        [254, 72, 0, 255],
        [254, 67, 0, 255],
        [254, 61, 0, 255],
        [254, 56, 0, 255],
        [254, 51, 0, 255],
        [254, 46, 0, 255],
        [254, 40, 0, 255],
        [254, 35, 0, 255],
        [254, 30, 0, 255],
        [254, 25, 0, 255],
        [254, 19, 0, 255],
        [254, 14, 0, 255],
        [254, 9, 0, 255],
        [254, 4, 0, 255],
        [253, 0, 0, 255],
        [248, 0, 0, 255],
        [243, 0, 0, 255],
        [237, 0, 0, 255],
        [232, 0, 0, 255],
        [227, 0, 0, 255],
        [222, 0, 0, 255],
        [216, 0, 0, 255],
        [211, 0, 0, 255],
        [206, 0, 0, 255],
        [201, 0, 0, 255],
        [195, 0, 0, 255],
        [190, 0, 0, 255],
        [185, 0, 0, 255],
        [180, 0, 0, 255],
        [174, 0, 0, 255],
        [169, 0, 0, 255],
        [169, 0, 0, 255],
        [169, 0, 0, 255],
        [169, 0, 0, 255],
        [169, 0, 0, 255],
        [229, 216, 202, 255],
        [0, 0, 0, 255],
    ]
)

all_dist = np.array(
    [
        # Artifically increase weight of 0 (it's actually 1.00000000e00)
        1.00000000e01,
        2.16892474e02,
        2.81664363e02,
        3.26735423e02,
        3.63356316e02,
        3.93812679e02,
        4.19998943e02,
        4.44209097e02,
        4.63926076e02,
        4.81457714e02,
        4.98040944e02,
        5.12962344e02,
        5.26344011e02,
        5.38808297e02,
        5.48777701e02,
        5.59450094e02,
        5.67691844e02,
        5.76649957e02,
        5.83178779e02,
        5.89517635e02,
        5.93749346e02,
        5.99720669e02,
        6.02946284e02,
        6.07410748e02,
        6.11657545e02,
        6.14082916e02,
        6.16104000e02,
        6.18886655e02,
        6.19711345e02,
        6.20714744e02,
        6.20599118e02,
        6.20611460e02,
        6.20799948e02,
        6.20924297e02,
        6.19812688e02,
        6.19821716e02,
        6.16102378e02,
        6.16091430e02,
        6.13392873e02,
        6.12829116e02,
        6.09185843e02,
        6.06333210e02,
        6.03657771e02,
        6.00295582e02,
        5.98028496e02,
        5.97478507e02,
        5.93476078e02,
        5.91624802e02,
        5.87433902e02,
        5.83837799e02,
        5.80588474e02,
        5.78635939e02,
        5.75195192e02,
        5.72234808e02,
        5.68733381e02,
        5.65016961e02,
        5.63293984e02,
        5.59545393e02,
        5.55513561e02,
        5.53865010e02,
        5.50291239e02,
        5.46900641e02,
        5.43589127e02,
        5.39821155e02,
        5.36973448e02,
        5.33468023e02,
        5.31093512e02,
        5.27251407e02,
        5.24142969e02,
        5.20585622e02,
        5.16486010e02,
        5.16020257e02,
        5.13017159e02,
        5.10933752e02,
        5.08819903e02,
        5.07357845e02,
        5.06128718e02,
        5.04127105e02,
        5.03787179e02,
        5.01799973e02,
        5.01590531e02,
        5.00540585e02,
        5.01687030e02,
        4.98494965e02,
        4.97843364e02,
        4.98878557e02,
        4.98679781e02,
        4.99360210e02,
        5.00478771e02,
        5.02431776e02,
        5.02862507e02,
        5.02636524e02,
        5.02139645e02,
        5.03776064e02,
        5.06358674e02,
        5.06631881e02,
        5.09067259e02,
        5.09579614e02,
        5.12146568e02,
        5.13180549e02,
        5.15762690e02,
        5.17201646e02,
        5.19944040e02,
        5.23523332e02,
        5.24536791e02,
        5.28586596e02,
        5.29133334e02,
        5.31325308e02,
        5.34884428e02,
        5.37088048e02,
        5.41864295e02,
        5.42997951e02,
        5.46937705e02,
        5.49462793e02,
        5.52908518e02,
        5.57127855e02,
        5.61743904e02,
        5.66049382e02,
        5.72589705e02,
        5.78182081e02,
        5.83616141e02,
        5.92029249e02,
        6.00582874e02,
        6.06957472e02,
        6.13106046e02,
        6.19657200e02,
        6.27711004e02,
        6.35343308e02,
        6.43913331e02,
        6.51980847e02,
        6.58247086e02,
        6.67034489e02,
        6.74663333e02,
        6.83182889e02,
        6.92355327e02,
        7.04651496e02,
        7.12680832e02,
        7.21794574e02,
        7.29632072e02,
        7.36834056e02,
        7.47037770e02,
        7.56274145e02,
        7.67517176e02,
        7.78136583e02,
        7.86192004e02,
        8.01163501e02,
        8.14858729e02,
        8.28291683e02,
        8.46690956e02,
        8.63261663e02,
        8.77916899e02,
        8.93466136e02,
        9.13291439e02,
        9.28395040e02,
        9.46908344e02,
        9.72867026e02,
        9.96352219e02,
        1.02182735e03,
        1.04668142e03,
        1.08322512e03,
        1.11182608e03,
        1.14676668e03,
        1.17349230e03,
        1.21319131e03,
        1.25178851e03,
        1.29762306e03,
        1.33932042e03,
        1.37965689e03,
        1.43276991e03,
        1.47655841e03,
        1.54400291e03,
        1.60202538e03,
        1.66722925e03,
        1.75361865e03,
        1.82670762e03,
        1.93027822e03,
        2.01421654e03,
        2.11195787e03,
        2.26406337e03,
        2.42722874e03,
        2.63222027e03,
        2.80435785e03,
        3.02479358e03,
        3.34278702e03,
        3.65861952e03,
        4.03828595e03,
        4.42421143e03,
        4.88597550e03,
        5.47565677e03,
        6.04212962e03,
        6.88358502e03,
        8.01444708e03,
        9.16598192e03,
        1.02234066e04,
        1.18932790e04,
        1.36146064e04,
        1.52465321e04,
        1.70802329e04,
        1.91896600e04,
        2.09578805e04,
        2.29773842e04,
        2.59592259e04,
        2.89503529e04,
        3.17549460e04,
        3.31480619e04,
        3.54971965e04,
        3.81688573e04,
        3.96127264e04,
        4.14086856e04,
        4.39680426e04,
        4.87003882e04,
        4.99023221e04,
        5.79024965e04,
        6.14565459e04,
        6.35120463e04,
        6.67641965e04,
        7.45356340e04,
        8.15832299e04,
        8.94997670e04,
        9.14315424e04,
        9.98791809e04,
        1.13173061e05,
        1.32077816e05,
        1.51287583e05,
        1.68678840e05,
        1.83922900e05,
        1.94427324e05,
        1.98593034e05,
        2.32184415e05,
        2.58967514e05,
        2.73653190e05,
        3.22705123e05,
        3.66836819e05,
        4.19429912e05,
        5.25936833e05,
        6.53748298e05,
        8.00827684e05,
        1.00447163e06,
        1.32789725e06,
        2.06204309e06,
        2.63709173e06,
        3.18424341e06,
        3.71495065e06,
        5.88784631e06,
        9.36167563e06,
        1.02875556e07,
        1.58672468e07,
        2.08037236e07,
        3.22816401e07,
        5.50686802e07,
        1.87233513e08,
        9.36167563e08,
        9.36167563e08,
        9.36167563e08,
        9.36167563e08,
        3.28233763e00,
    ]
)
